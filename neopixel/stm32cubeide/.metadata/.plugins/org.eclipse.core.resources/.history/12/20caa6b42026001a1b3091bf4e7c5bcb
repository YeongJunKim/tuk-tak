/*
 * Neopixel.h
 *
 *  Created on: Dec 24, 2019
 *      Author: colson
 */

#ifndef NEOPIXEL_H_
#define NEOPIXEL_H_

#include "main.h"
#include "stdlib.h"

extern TIM_HandleTypeDef htim1;

class Neopixel {
public:
	uint8_t *led_buf;
	uint32_t size;

	Neopixel(){

	};
	Neopixel(uint32_t led_cnt_, uint8_t colors_)
	{
		size = sizeof(uint8_t) * led_cnt_ * colors_;
		led_buf = (uint8_t *)malloc(size);
		for(uint32_t i = 0; i < size; i++)
		{
			led_buf[i] = 0x00;
		}
	};
	~Neopixel();

	void begin(void){
		HAL_TIM_PWM_Start_DMA(&htim1, TIM_CHANNEL_1, (uint32_t*)this->led_buf, size);
	}
	void stop(void){
		HAL_TIM_PWM_Stop_DMA(&htim1, TIM_CHANNEL_1);
	}
	void SetColor(uint32_t index, uint8_t red, uint8_t green, uint8_t blue)
	{
	}
	void SetColor(uint32_t index, uint8_t red, uint8_t green, uint8_t blue, uint8_t white);
};

#endif /* NEOPIXEL_H_ */
